           stepFrequent:=round(CaTanDeg);//кол-во пикселей в частом штрихе
           StringDiv:=frac(CaTanDeg);//выборка дробной части катангенса
           znak:=sign(0.5-StringDiv)*sign(StringDiv);//указывает на увеличение или уменьшение результата суммирования этой дробной части при повторе частых штрихов
           stepsBig:=round(1/StringDiv)+1;//!!!!!!!!увеличил на единицу только потому что в коде применяется только в таком виде
           stepRare:=stepFrequent+znak;//количество пикселей в редком штрихе. промежуточный, пока не нужен.
           bigStep:= stepsBig*stepFrequent;//поправил
           if bigStep=0 then begin
           bigStep:=stepRare;
           stepRare:=0; 

          procedure Vstavka;
          begin
           //CaTanDegP:=round(CaTanDeg);
           //StringDiv:=RazmerX / (CaTanDeg);
           stepFrequent:=round(CaTanDeg);//кол-во пикселей в частом штрихе
           StringDiv:=frac(CaTanDeg);//выборка дробной части катангенса
           StringDiv1:=1-StringDiv;
           znak:=sign(0.5-StringDiv)*sign(StringDiv);//указывает на увеличение или уменьшение результата суммирования этой дробной части при повторе частых штрихов
           if StringDiv>0.5 then  stepsBig:=round(1/StringDiv1) else stepsBig:=round(1/StringDiv);
           if StringDiv=0 then  stepsBig:=1;
           Ostatok:=1;
           if CaTanDeg=1 then Ostatok:=0;
//           stepsBig:=round(1/StringDiv1);//
           stepRare:=stepFrequent+znak;//количество пикселей в редком штрихе. промежуточный, пока не нужен.
           bigStep:= stepsBig*stepFrequent;//поправил
           if bigStep=0 then begin
           bigStep:=stepRare;
           stepRare:=0;

           end;
           end;  