<html>
<head>

<link rel="icon" type="image/x-icon" href="data:image/gif;base64,R0lGODlhEAAQAPcAALIZKaYrOZ9Xaoc/PYw0KpAyKYkfHLMoJ8swLsEvK5EhH4wmKNY7Q9Q8R81BTs9EUcIcMq49RYU8M3cnGaA9Ma8sJ9kpJ9wVHc0bHNcrKdUxLYojG503O8o9SdVBTeBDUbksPKM2NnAiFo00J54vKFoIClAAAG8CB28EBogECcEVHdUhH7kpJ5w3Ns1DS+E/TLMoN4AmH30pHJ03KVkICjYAAmwSDakrLKYuLZUgIJEWGIAMDXwGCIcWF5YoLtw3RZ4mKnEfFY0qHnwZFFEKCyECBHAXFbgjJcopKbUvKqEzLoQlIIkpIpMnJY4WHZshKZQZGIIcFpocFm0FCFUQD0QSFZQKFswbIs4bI5QfGKsfJYUAD4QIF44eHqwYH3UNEpwWGKUXG5MRF6AdIUYHCCUEA08ABKUiJIw1MEYcE60dIHsACKcBFpoRFNQRI3wGDp8VGboLHqgcJskhJHsLD3MhG3MmIbcqK+MOJHsCD84LGIoAD6gFG6sJGNEMJnsDDXoFCd4AHLYTJMEZHLoWHqggI84XIvwCI/8IMMEPId8ICuEYK7wMI8EQIb4GIGsCCoIHEPgAF84BH8UJGckNIKwQG6kCFZ4BDsMDEtIDGN0DFNYHG8kII74GH64AGFMBCHYOF+wAEOcAGtMAFd0CGZIGDm4DDG8NFaYDD+QFHeQDHM4DG8MCHa8AE5MLF4UZIXQdIqkACv8AIPABIe0AILQCFE4EBRUKCnEED+YDHuIAIc8DI7IIHqkiLrg2P7IyPZgtNJYBCrIAEv8RQf8GN/8DJZwDEWsFEXgADugDJOIVNsUTJtsyQ9U0Q9w1SNQ0RZ1KUewjNKsUGZIFCaQAAK4AAIwAAJUABYUAAIcABIkAB7IAFOw2TuIxR+4qQ/AwR4tSWalSW+9JWPlHV+ZFU9VTYMxhbcZfarNIUbEbLb0LIccXKvVJYfJRc/9EZPM8WIJUWoFWXZJTXeFHVu5QZOFketZZbNFMYLE3RLY0Q9NEV9kzR+JEXudYd8JEX4ckNiH/C05FVFNDQVBFMi4wAwEAAAAh+QQEewABACwAAAAAEAAQAAAI/wABQAABAwgUMHAAQQIFCxg0cPACRAgRI0iUMHECRQoVK1i0cPEESBAhQ4gUMXIESRIlS5g0cfIGTBgxY8iUMXMGTRo1a9i0cfMIUCBBgwgVMnQIUSJFixg1cvQKVChRo0iVMnUKVSpVq1i1cvUMWDBhw4gVM3YMWTJly5g1c/YOXDhx48iVM3cOXTp169i1c/cQYECBAwkWNHgQYUKFCxk2dPgSZEiRI0mWNHkSZUqVK1m2dPkUaFChQ4kWNXoUaVKlS5k2dfoWbFixY8mWNXsWbVq1a9m2dfsYcGDBgwkXNnwYcWLFixk3dvwadGjRo0mXNn0adWrVq1m3dv0ceCRw4cOJFzd+HHly5cuZN3f+Hnx48ePJlzd/Hn169evZt3f/BAQAOw==">
<title>A-trace-map-generator</title>
<style>
table,td{padding:2px;border:5px solid blue;border-collapse: collapse;border-spacing: 0;}
</style>
</head>
<body>



<table id="tb"></table>

<script>
let p=1;
let x=10;
let Biger=2;
//*********************
let steps=1;
let stepFrequent=1;
let Edge=1;
let steps1=2;
let  stepRare=1;
let  stepsBig=1;
//*********************
let TracerY=0;
let y=1;
let xRazmerX=1;
let yRazmerY=1;
//************
let CaTanDegP=0;
//************




let n=0;

f();

//alert(n);

function fn3(){
    do {//      repeat//vvvvvvvvvvv3333
        xf=x+1;//    xf := x + 1;
            //если раскомментироваnm строки После jmp p  то начнётся вывод данных в таблицу
		//let a=(xf-1)*RazmerY+yf-1;	//
		let a=(xf)*RazmerY+yf;	//
		//console.log(p+' '+TracerY+',' + '1');
		//alert(p+' '+TracerY);
		switch (p){
            case 1:
              //StringGrid1.Cells[xf, yf] :=
              ///*
			  n++;
			  document.getElementById('c'+a).innerText=TracerX + ',' + TracerY + ',' + 1;
			  //alert('c'+(xf*RazmerY+yf));
			  //IntToStr(TracerX) + ',' + IntToStr(TracerY) + ',' + '1';
            //запись правого столбца
            p=3;
            //goto p4;
			
            case 2: if (p!=3){
             //console.log(',' + '0');// StringGrid1.Cells[xf, yf] := IntToStr(xf) + ',' + IntToStr(yf) + ',' + '0';
			 document.getElementById('c'+a).innerText= xf + ',' + yf + ',0';			 
            //автоматическое забивание координат в местах скоса трассы
            p=3;//p := @p3;//
            //goto p4;
			}
            case 3: if (p!=3){
             //console.log(',' + '0');//StringGrid1.Cells[xf, yf] := IntToStr(xf) + ',' + IntToStr(y) + ',' + '0';
			 document.getElementById('c'+a).innerText= xf + ',' + y + ',0';			 
            //автоматическое забивание координат трассы на прямых участках
			}
            case 4://
        x--;  //    Dec(x);
		}
		
    } while (x>=Biger); //     until x < Biger;	
}	

function fn2(){ 

 do{//repeat///vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv222
          if (!steps)
          {//begin
            Biger= x - stepRare+1;
            steps= stepsBig+1;
          }//end
          else
          {//begin
            Biger= x - stepFrequent + 1;
          }//end;
          if (Biger < 0) Biger= 0;
		  
		  
		  
		  
fn3();//function fn3();
		  

		switch (Edge){
		
		case 1:
			steps1++;
			//goto Edge3;
			
		case 2:
			if(Edge!=1){

				if (RazmerX > RazmerY) 
					{//begin
						steps2++;//inc (steps2);
						steps1--;//Dec(steps1);
						if (y < (stepsBig+1))   
							{//begin
								TracerX= x - (stepFrequent * y  + znak * Math.trunc(y / (stepsBig+1))+znak *trunc((y+steps2) / (stepsBig+1)))+1;
								if ((y+steps2) == (stepsBig+1)) 
									{//begin
									   TracerX=x-(stepFrequent * y  + znak * Math.trunc(y / (stepsBig+1)))+1;
									}//end;


								if (steps ==0)steps2 = 0;
							}//end 
							else 
							{///begin
							TracerX = x - (stepFrequent * y  + znak * Math.trunc(y / (stepsBig+1)))+1;
							}//end;
				  


						if (TracerX<1) 
							{//begin
							   TracerY = y - steps1;
							   TracerX = 0;
							   if (TracerY < 0) TracerY = 0;
							}//end;
					}//end 
					else 
					{//begin
					   steps1--;
					   TracerY = y - steps1;
					   TracerX = 0;
					}//if RazmerX > RazmerY
				
				p=1;
				//o Edge4;
			}
		  
		case 3:
			if(Edge!=2) p=2;
		case 4:
			steps--;
		}//switch	
	}while(x>=0);//    until x < 0;		

		//^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
}//fn2	

function fn1(){
    do{// vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv1111

		
		
        logic1://пропускаем первую строку
         logic=2;// logic := @logic2;
        //goto logic4;
		
		
		
        logic2: if(logic!=1){
         Edge=3;// 
        logic=3;//;
		}
		
		
        logic3: if(logic!=1||logic!=2){
        ///*  
		TracerY = y - steps1;//расчёт ячейки правого столбца
        TracerX = 0;
        if (TracerY < 0)// then
        {//begin
        ///*  
		TracerX = RazmerX - (stepFrequent * y + znak *Math.trunc(y / (stepsBig+1)));//(stepFrequent * y + znak *trunc(y / (stepsBig+1)))
          if (TracerX < 0) TracerX = 0;
          TracerY = 0;
        }//end;
		}
		
		
        logic4:
          steps = stepsBig;
		  
		  
fn2();

        y++;
        yf = y + 1;
        p=1;//p := @p1;
        x = xRazmerX;
     }while(y <= (yRazmerY - 1));// until y > yRazmerY - 1;
 
}	 
//vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
function fn0(){	
    do{//repeat	
 fn1();	  
      Edge=2;//Edge := @Edge2;
    }while(y <= yRazmerY);//until y > yRazmerY;
}	

	//^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
function f()
  {//begin //begin steps1
	CaTanDegP=300000;
    deg = 43;//StrToInt(Edit1.Text);
    RazmerX = 15;//StrToInt(Edit2.Text);
    RazmerY = 10;//StrToInt(Edit3.Text);
    ///*StringGrid1.RowCount := RazmerY + 2;
    //{ Установка количества строк компонента StringGrid}
    ///*StringGrid1.ColCount := RazmerX + 2;
    ////////////////////////////////////////////////////////////////////////////////
    ocantovca();
    ////////////////////////////////////////////////////////////////////////////////
    TanDeg = Math.tan((deg*Math.PI/180));///DegToRad
    
    if (TanDeg == 0) //then
			{//begin
			  CaTanDeg = RazmerX;
			  CaTanDegP = Math.trunc(CaTanDeg);//CaTanDeg|0;//Trunc(CaTanDeg);
			  //px = @x;
			  //py = @y;
			  StringFinish = 0;
			  Ostatok = 0;
			  Vstavka();
			}//end
    else
    {//begin
      CaTanDeg = 1 / TanDeg;
      if (CaTanDeg >= TanDeg)// then
      {//begin
        //px = @x;
        //py = @y;
        Vstavka();
        if (CaTanDegP > 28)  CaTanDegP = 27;//then
      }//end
      else
      {//begin
        //px = @y;
        //py = @x;
        Vstavka();
        if (CaTanDegP > 28)  CaTanDegP = 27;//then
      }//end;
    }//end;
    if (CaTanDegP == 0)// then
    {///begin
      StringFinish = 0;
      Ostatok = 0;
    }//end
    else
    {//begin
      StringDivTrunc = RazmerX % CaTanDegP//Trunc();
      //StringFinish:=28-steps*CaTanDegP;
      Ostatok = 28 - StringDivTrunc * CaTanDegP;

    }//end;



    x= RazmerX - 1;
    xRazmerX = x;
    StringStart = x;
    yRazmerY= RazmerY - 1;
    y = 0;
    TracerY = 0;
    TracerX = 0;
    steps = 0;
    logic=1;//logic := @logic1;
    p=1;//
   Edge=1;//
    steps1 = 0;
    xf = 0;
    yf = y + 1;
    stepFrequentD = stepFrequent;
    stepsBigD = 1 / (stepsBig + 1);
    steps2=1;
    // для отладки первой фазы--------------------------------------------------------------------------------------------------------
    //runTime := gettickcount;//64;
	
fn0();//^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
	
    //runTime = gettickcount - runTime; //  64
    ///*Label5.Caption := IntToStr(runTime);
  }//end;
//}// end f


function ocantovca(){
let a='';//${i} ${j}
for (let i=0;i<=RazmerY;i++){//'c'+xf*RazmerY+yf
a+='<tr>';
//for (let j=0;j<=RazmerX;j++){a+=`<td id="${(i*j)?'c':'x'}${(j-1)*RazmerY+i-1}"${(i*j)?'':' bgcolor=lime'}></td>`}
for (let j=0;j<=RazmerX;j++){a+=`<td id="${(i*j)?'c':'x'}${(j)*RazmerY+i}"${(i*j)?'':' bgcolor=lime'}>${(i*j)?'':(i+j)?i+j-1:''}</td>`}
a+='</tr>';
}
tb.innerHTML=a;
}

function Vstavka(){
      stepFrequent = Math.round(CaTanDeg);
      //StringDiv = CaTanDeg-CaTanDeg|0;//Math.fraction(CaTanDeg);
	  StringDiv = CaTanDeg-(CaTanDeg|0);

      StringDiv1 = 1 - StringDiv;
      znak = Math.sign(0.5 - StringDiv) * Math.sign(StringDiv);
      if (StringDiv > 0.5)// then
        {stepsBig = Math.round(1 / StringDiv1)}
      else
        {stepsBig = Math.round(1 / StringDiv)};
      if (StringDiv == 0)   stepsBig = 1;//then
      Ostatok1 = 1;
      if (CaTanDeg == 1) //then
        {//begin
          znak = 0;
          Ostatok1 = 0;
        }//end;
      stepRare = stepFrequent + znak;
      bigStep = stepsBig * stepFrequent;//поправил
      if (bigStep == 0) //then
      {//begin
        bigStep = stepRare;
        stepRare = 0;
      }//end;
   ///* Label1.Caption := IntToStr(stepRare);
   ///* Label2.Caption := IntToStr(stepFrequent);
   ///* Label6.Caption := IntToStr(stepsBig);
//      if stepsBig > 1 then stepsBig := stepsBig + 1;
    incTracerY=0;
}


</script>
</body>
</html>